

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SQLObject FAQ &#8212; SQLObject 3.2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SQLBuilder" href="SQLBuilder.html" />
    <link rel="prev" title="SQLObject" href="SQLObject.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="SQLBuilder.html" title="SQLBuilder"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="SQLObject.html" title="SQLObject"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SQLObject 3.2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">SQLObject FAQ</a><ul>
<li><a class="reference internal" href="#sqlexpression">SQLExpression</a><ul>
<li><a class="reference internal" href="#how-does-the-select-method-know-what-to-do">How does the select(...) method know what to do?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#why-there-is-no-len">Why there is no __len__?</a></li>
<li><a class="reference internal" href="#how-can-i-do-a-left-join">How can I do a LEFT JOIN?</a><ul>
<li><a class="reference internal" href="#simple">Simple</a></li>
<li><a class="reference internal" href="#efficient">Efficient</a></li>
<li><a class="reference internal" href="#sql-wise">SQL-wise</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-can-i-join-a-table-with-itself">How can I join a table with itself?</a></li>
<li><a class="reference internal" href="#how-can-i-define-my-own-intermediate-table-in-my-many-to-many-relationship">How can I define my own intermediate table in my Many-to-Many relationship?</a></li>
<li><a class="reference internal" href="#how-does-inheritance-work">How Does Inheritance Work?</a></li>
<li><a class="reference internal" href="#composite-compound-attributes">Composite/Compound Attributes</a></li>
<li><a class="reference internal" href="#non-integer-ids">Non-Integer IDs</a></li>
<li><a class="reference internal" href="#binary-values">Binary Values</a></li>
<li><a class="reference internal" href="#reloading-modules">Reloading Modules</a></li>
<li><a class="reference internal" href="#python-keywords">Python Keywords</a></li>
<li><a class="reference internal" href="#lazy-updates-and-insert">Lazy Updates and Insert</a></li>
<li><a class="reference internal" href="#mutually-referencing-tables">Mutually referencing tables</a></li>
<li><a class="reference internal" href="#what-about-group-by-union-etc">What about GROUP BY, UNION, etc?</a></li>
<li><a class="reference internal" href="#how-to-do-mass-insertion">How to do mass-insertion?</a></li>
<li><a class="reference internal" href="#how-can-i-specify-the-mysql-engine-to-use-or-tweak-other-sql-engine-specific-features">How can I specify the MySQL engine to use, or tweak other SQL-engine specific features?</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="SQLObject.html"
                        title="previous chapter">SQLObject</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="SQLBuilder.html"
                        title="next chapter">SQLBuilder</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/FAQ.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sqlobject-faq">
<h1><a class="toc-backref" href="#id1">SQLObject FAQ</a><a class="headerlink" href="#sqlobject-faq" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#sqlobject-faq" id="id1">SQLObject FAQ</a><ul>
<li><a class="reference internal" href="#sqlexpression" id="id2">SQLExpression</a><ul>
<li><a class="reference internal" href="#how-does-the-select-method-know-what-to-do" id="id3">How does the select(...) method know what to do?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#why-there-is-no-len" id="id4">Why there is no __len__?</a></li>
<li><a class="reference internal" href="#how-can-i-do-a-left-join" id="id5">How can I do a LEFT JOIN?</a><ul>
<li><a class="reference internal" href="#simple" id="id6">Simple</a></li>
<li><a class="reference internal" href="#efficient" id="id7">Efficient</a></li>
<li><a class="reference internal" href="#sql-wise" id="id8">SQL-wise</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-can-i-join-a-table-with-itself" id="id9">How can I join a table with itself?</a></li>
<li><a class="reference internal" href="#how-can-i-define-my-own-intermediate-table-in-my-many-to-many-relationship" id="id10">How can I define my own intermediate table in my Many-to-Many relationship?</a></li>
<li><a class="reference internal" href="#how-does-inheritance-work" id="id11">How Does Inheritance Work?</a></li>
<li><a class="reference internal" href="#composite-compound-attributes" id="id12">Composite/Compound Attributes</a></li>
<li><a class="reference internal" href="#non-integer-ids" id="id13">Non-Integer IDs</a></li>
<li><a class="reference internal" href="#binary-values" id="id14">Binary Values</a></li>
<li><a class="reference internal" href="#reloading-modules" id="id15">Reloading Modules</a></li>
<li><a class="reference internal" href="#python-keywords" id="id16">Python Keywords</a></li>
<li><a class="reference internal" href="#lazy-updates-and-insert" id="id17">Lazy Updates and Insert</a></li>
<li><a class="reference internal" href="#mutually-referencing-tables" id="id18">Mutually referencing tables</a></li>
<li><a class="reference internal" href="#what-about-group-by-union-etc" id="id19">What about GROUP BY, UNION, etc?</a></li>
<li><a class="reference internal" href="#how-to-do-mass-insertion" id="id20">How to do mass-insertion?</a></li>
<li><a class="reference internal" href="#how-can-i-specify-the-mysql-engine-to-use-or-tweak-other-sql-engine-specific-features" id="id21">How can I specify the MySQL engine to use, or tweak other SQL-engine specific features?</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="sqlexpression">
<h2><a class="toc-backref" href="#id2">SQLExpression</a><a class="headerlink" href="#sqlexpression" title="Permalink to this headline">¶</a></h2>
<p>In <cite>SomeTable.select(SomeTable.q.Foo &gt; 30)</cite> why doesn&#8217;t the inner parameter,
<cite>SomeTable.q.Foo &gt; 30</cite>, get evaluated to some boolean value?</p>
<p><cite>q</cite> is an object that returns special attributes of type
<cite>sqlbuilder.SQLExpression</cite>. SQLExpression is a special class that overrides
almost all Python magic methods and upon any operation instead of
evaluating it constructs another instance of SQLExpression that remembers
what operation it has to do. This is similar to a symbolic algebra.
Example:</p>
<blockquote>
<div>SQLExpression(&#8220;foo&#8221;) &gt; 30</div></blockquote>
<p>produces SQLExpression(&#8220;foo&#8221;, &#8220;&gt;&#8221;, 30) (well, it really produces
SQLExpression(SQLExpression(&#8220;foo&#8221;)...))</p>
<div class="section" id="how-does-the-select-method-know-what-to-do">
<h3><a class="toc-backref" href="#id3">How does the select(...) method know what to do?</a><a class="headerlink" href="#how-does-the-select-method-know-what-to-do" title="Permalink to this headline">¶</a></h3>
<p>In short, select() recursively evaluates the top-most SQLExpression to a
string:</p>
<blockquote>
<div>SQLExpression(&#8220;foo&#8221;, &#8220;&gt;&#8221;, 30) =&gt; &#8220;foo &gt; 30&#8221;</div></blockquote>
<p>and passes the result as a string to the SQL backend.</p>
<p>The longer but more detailed and correct explanation is that select()
produces an instance of <a class="reference external" href="SelectResults.html">SelectResults</a> class that upon being iterated over
produces an instance of Iteration class that upon calling its next()
method (it is iterator!) constructs the SQL query string, passes it to the
backend, fetches the results, wraps every row as SQLObject instance and
passes them back to the user.</p>
<p>For the details of the implementation see sqlobject/main.py for SQLObject,
sqlobject/sqlbuilder.py for SQLExpression, sqlobject/dbconnection.py for
DBConnection class (that constructs the query strings) and Iteration class,
and different subdirectories of sqlobject for concrete implementations of
connection classes - different backends require different query strings.</p>
</div>
</div>
<div class="section" id="why-there-is-no-len">
<h2><a class="toc-backref" href="#id4">Why there is no __len__?</a><a class="headerlink" href="#why-there-is-no-len" title="Permalink to this headline">¶</a></h2>
<p>There are reasons why there is no __len__ method, though many people think
having those make them feel more integrated into Python.</p>
<p>One is that len(foo) is expected to be fast, but issuing a COUNT query can
be slow.  Worse, often this causes the database to do essentially redundant
work when the actual query is performed (generally taking the len of a
sequence is followed by accessing items from that sequence).</p>
<p>Another is that list(foo) implicitly tries to do a len first, as an
optimization (because len is expected to be cheap &#8211; see previous point).
Worse, it swallows <em>all</em> exceptions that occur during that call to __len__,
so if it fails (e.g. there&#8217;s a typo somewhere in the query), the original
cause is silently discarded, and instead you&#8217;re left with mysterious errors
like &#8220;current transaction is aborted, commands ignored until end of
transaction block&#8221; for no apparent reason.</p>
</div>
<div class="section" id="how-can-i-do-a-left-join">
<h2><a class="toc-backref" href="#id5">How can I do a LEFT JOIN?</a><a class="headerlink" href="#how-can-i-do-a-left-join" title="Permalink to this headline">¶</a></h2>
<p>The short: you can&#8217;t.  You don&#8217;t need to.  That&#8217;s a relational way of
thinking, not an object way of thinking.  But it&#8217;s okay!  It&#8217;s not
hard to do the same thing, even if it&#8217;s not with the same query.</p>
<p>For these examples, imagine you have a bunch of customers, with
contacts.  Not all customers have a contact, some have several.  The
left join would look like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">customer</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">first_name</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">last_name</span><span class="p">,</span>
       <span class="n">contact</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">contact</span><span class="o">.</span><span class="n">address</span>
<span class="n">FROM</span> <span class="n">customer</span>
<span class="n">LEFT</span> <span class="n">JOIN</span> <span class="n">contact</span> <span class="n">ON</span> <span class="n">contact</span><span class="o">.</span><span class="n">customer_id</span> <span class="o">=</span> <span class="n">customer</span><span class="o">.</span><span class="n">id</span>
</pre></div>
</div>
<div class="section" id="simple">
<h3><a class="toc-backref" href="#id6">Simple</a><a class="headerlink" href="#simple" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">customer</span> <span class="ow">in</span> <span class="n">Customer</span><span class="o">.</span><span class="n">select</span><span class="p">():</span>
    <span class="nb">print</span> <span class="n">customer</span><span class="o">.</span><span class="n">firstName</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">lastName</span>
    <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="n">customer</span><span class="o">.</span><span class="n">contacts</span><span class="p">:</span>
        <span class="nb">print</span> <span class="s1">&#39;   &#39;</span><span class="p">,</span> <span class="n">contact</span><span class="o">.</span><span class="n">phoneNumber</span>
</pre></div>
</div>
<p>The effect is the same as the left join &#8211; you get all the customers,
and you get all their contacts.  The problem, however, is that you
will be executing more queries &#8211; a query for each customer to fetch
the contacts &#8211; where with the left join you&#8217;d only do one query.  The
actual amount of information returned from the database will be the
same.  There&#8217;s a good chance that this won&#8217;t be significantly slower.
I&#8217;d advise doing it this way unless you hit an actual performance
problem.</p>
</div>
<div class="section" id="efficient">
<h3><a class="toc-backref" href="#id7">Efficient</a><a class="headerlink" href="#efficient" title="Permalink to this headline">¶</a></h3>
<p>Lets say you really don&#8217;t want to do all those queries.  Okay, fine:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">custContacts</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="n">Contact</span><span class="o">.</span><span class="n">select</span><span class="p">():</span>
    <span class="n">custContacts</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">contact</span><span class="o">.</span><span class="n">customerID</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>
<span class="k">for</span> <span class="n">customer</span> <span class="ow">in</span> <span class="n">Customer</span><span class="o">.</span><span class="n">select</span><span class="p">():</span>
    <span class="nb">print</span> <span class="n">customer</span><span class="o">.</span><span class="n">firstName</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">lastName</span>
    <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="n">custContacts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">customer</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="nb">print</span> <span class="s1">&#39;   &#39;</span><span class="p">,</span> <span class="n">contact</span><span class="o">.</span><span class="n">phoneNumber</span>
</pre></div>
</div>
<p>This way there will only be at most two queries.  It&#8217;s a little more
crude, but this is an optimization, and optimizations often look less
than pretty.</p>
<p>But, say you don&#8217;t want to get everyone, just some group of people
(presumably a large enough group that you still need this
optimization):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">firstName</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">)</span>
<span class="n">custContacts</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="n">Contact</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">AND</span><span class="p">(</span><span class="n">Contact</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">customerID</span> <span class="o">==</span> <span class="n">Customer</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                                  <span class="n">query</span><span class="p">)):</span>
    <span class="n">custContacts</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">contact</span><span class="o">.</span><span class="n">customerID</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>
<span class="k">for</span> <span class="n">customer</span> <span class="ow">in</span> <span class="n">Customer</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
    <span class="nb">print</span> <span class="n">customer</span><span class="o">.</span><span class="n">firstName</span><span class="p">,</span> <span class="n">customer</span><span class="o">.</span><span class="n">lastName</span>
    <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="n">custContacts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">customer</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="nb">print</span> <span class="s1">&#39;   &#39;</span><span class="p">,</span> <span class="n">contact</span><span class="o">.</span><span class="n">phoneNumber</span>
</pre></div>
</div>
</div>
<div class="section" id="sql-wise">
<h3><a class="toc-backref" href="#id8">SQL-wise</a><a class="headerlink" href="#sql-wise" title="Permalink to this headline">¶</a></h3>
<p>Use LEFTJOIN() from <a class="reference external" href="SQLBuilder.html">SQLBuilder</a>.</p>
</div>
</div>
<div class="section" id="how-can-i-join-a-table-with-itself">
<h2><a class="toc-backref" href="#id9">How can I join a table with itself?</a><a class="headerlink" href="#how-can-i-join-a-table-with-itself" title="Permalink to this headline">¶</a></h2>
<p>Use Alias from <a class="reference external" href="SQLBuilder.html">SQLBuilder</a>. See <a class="reference external" href="SQLObject.html#how-can-i-join-a-table-with-itself">example</a>.</p>
</div>
<div class="section" id="how-can-i-define-my-own-intermediate-table-in-my-many-to-many-relationship">
<h2><a class="toc-backref" href="#id10">How can I define my own intermediate table in my Many-to-Many relationship?</a><a class="headerlink" href="#how-can-i-define-my-own-intermediate-table-in-my-many-to-many-relationship" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In User and Role, SQLRelatedJoin is used with createRelatedTable=False
so the intermediate table is not created automatically. We also set the
intermediate table name with intermediateTable=&#8217;user_roles&#8217;.
UserRoles is the definition of our intermediate table.
UserRoles creates a unique index to make sure we don&#8217;t have duplicate
data in the database.
We also added an extra field called active which has a boolean value.
The active column might be used to activate/deactivate a given role for
a user in this example.
Another common field to add in this an intermediate table might be a sort
field.
If you want to get a list of rows from the intermediate table directly
add a MultipleJoin to User or Role class.</p>
</div>
<p>We&#8217;ll expand on the User and Role example and define our own UserRoles class which
will be the intermediate table for the User and Role Many-to-Many relationship.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">class</span> <span class="nc">sqlmeta</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">table</span> <span class="o">=</span> <span class="s2">&quot;user_table&quot;</span>
<span class="gp">... </span>    <span class="n">username</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">(</span><span class="n">alternateID</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">roles</span> <span class="o">=</span> <span class="n">SQLRelatedJoin</span><span class="p">(</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">intermediateTable</span><span class="o">=</span><span class="s1">&#39;user_roles&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">createRelatedTable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Role</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">(</span><span class="n">alternateID</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">users</span> <span class="o">=</span> <span class="n">SQLRelatedJoin</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">intermediateTable</span><span class="o">=</span><span class="s1">&#39;user_roles&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">createRelatedTable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">UserRoles</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">class</span> <span class="nc">sqlmeta</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">table</span> <span class="o">=</span> <span class="s2">&quot;user_roles&quot;</span>
<span class="gp">... </span>    <span class="n">user</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="n">notNull</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cascade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">role</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&#39;Role&#39;</span><span class="p">,</span> <span class="n">notNull</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cascade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">active</span> <span class="o">=</span> <span class="n">BoolCol</span><span class="p">(</span><span class="n">notNull</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">unique</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">DatabaseIndex</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="how-does-inheritance-work">
<h2><a class="toc-backref" href="#id11">How Does Inheritance Work?</a><a class="headerlink" href="#how-does-inheritance-work" title="Permalink to this headline">¶</a></h2>
<p>SQLObject is not intended to represent every Python inheritance
structure in an RDBMS &#8211; rather it is intended to represent RDBMS
structures as Python objects.  So lots of things you can do in Python
you can&#8217;t do with SQLObject classes.  However, some form of
inheritance is possible.</p>
<p>One way of using this is to create local conventions.  Perhaps:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SiteSQLObject</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="n">_connection</span> <span class="o">=</span> <span class="n">DBConnection</span><span class="o">.</span><span class="n">MySQLConnection</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
    <span class="n">_style</span> <span class="o">=</span> <span class="n">MixedCaseStyle</span><span class="p">()</span>

    <span class="c1"># And maybe you want a list of the columns, to autogenerate</span>
    <span class="c1"># forms from:</span>
    <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">]</span>
</pre></div>
</div>
<p>Since SQLObject doesn&#8217;t have a firm introspection mechanism (at least
not yet) the example shows the beginnings of a bit of ad hoc
introspection (in this case exposing the <code class="docutils literal"><span class="pre">_columns</span></code> attribute in a
more pleasing/public interface).</p>
<p>However, this doesn&#8217;t relate to <em>database</em> inheritance at all, since
we didn&#8217;t define any columns.  What if we do?</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="n">firstName</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">()</span>
    <span class="n">lastName</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Employee</span><span class="p">(</span><span class="n">Person</span><span class="p">):</span>
    <span class="n">position</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">()</span>
</pre></div>
</div>
<p>Unfortunately, the resultant schema probably doesn&#8217;t look like what
you might have wanted:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">person</span> <span class="p">(</span>
    <span class="nb">id</span> <span class="n">INT</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>
    <span class="n">first_name</span> <span class="n">TEXT</span><span class="p">,</span>
    <span class="n">last_name</span> <span class="n">TEXT</span>
<span class="p">);</span>

<span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">employee</span> <span class="p">(</span>
    <span class="nb">id</span> <span class="n">INT</span> <span class="n">PRIMARY</span> <span class="n">KEY</span>
    <span class="n">first_name</span> <span class="n">TEXT</span><span class="p">,</span>
    <span class="n">last_name</span> <span class="n">TEXT</span><span class="p">,</span>
    <span class="n">position</span> <span class="n">TEXT</span>
<span class="p">)</span>
</pre></div>
</div>
<p>All the columns from <code class="docutils literal"><span class="pre">person</span></code> are just repeated in the <code class="docutils literal"><span class="pre">employee</span></code>
table.  What&#8217;s more, an ID for a Person is distinct from an ID for an
employee, so for instance you must choose <code class="docutils literal"><span class="pre">ForeignKey(&quot;Person&quot;)</span></code> or
<code class="docutils literal"><span class="pre">ForeignKey(&quot;Employee&quot;)</span></code>, you can&#8217;t have a foreign key that
sometimes refers to one, and sometimes refers to the other.</p>
<p>Altogether, not very useful.  You probably want a <code class="docutils literal"><span class="pre">person</span></code> table,
and then an <code class="docutils literal"><span class="pre">employee</span></code> table with a one-to-one relation between the
two.  Of course, you can have that, just create the appropriate
classes/tables &#8211; but it will appear as two distinct classes, and
you&#8217;d have to do something like <code class="docutils literal"><span class="pre">Person(1).employee.position</span></code>.  Of
course, you can always create the necessary shortcuts, like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="n">firstName</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">()</span>
    <span class="n">lastName</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_employee</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">Employee</span><span class="o">.</span><span class="n">selectBy</span><span class="p">(</span><span class="n">person</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> is not an employee&#39;</span> <span class="o">%</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="nf">_get_isEmployee</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">Employee</span><span class="o">.</span><span class="n">selectBy</span><span class="p">(</span><span class="n">person</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># turn into a bool:</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="ow">not</span> <span class="n">value</span>
    <span class="k">def</span> <span class="nf">_set_isEmployee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="c1"># Make sure we are an employee...</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isEmployee</span><span class="p">:</span>
                <span class="n">Empoyee</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">person</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isEmployee</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">employee</span><span class="o">.</span><span class="n">destroySelf</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_get_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">employee</span><span class="o">.</span><span class="n">position</span>
    <span class="k">def</span> <span class="nf">_set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">employee</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">value</span>

<span class="k">class</span> <span class="nc">Employee</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="n">person</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&#39;Person&#39;</span><span class="p">)</span>
    <span class="n">position</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">()</span>
</pre></div>
</div>
<p>There is also another kind of inheritance. See <a class="reference external" href="Inheritance.html">Inheritance.html</a></p>
</div>
<div class="section" id="composite-compound-attributes">
<h2><a class="toc-backref" href="#id12">Composite/Compound Attributes</a><a class="headerlink" href="#composite-compound-attributes" title="Permalink to this headline">¶</a></h2>
<p>A composite attribute is an attribute formed from two columns.  For
example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">invoice_item</span> <span class="p">(</span>
    <span class="nb">id</span> <span class="n">INT</span> <span class="n">PRIMARY</span> <span class="n">KEY</span><span class="p">,</span>
    <span class="n">amount</span> <span class="n">NUMERIC</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">currency</span> <span class="n">CHAR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Now, you&#8217;ll probably want to deal with one amount/currency value,
instead of two columns.  SQLObject doesn&#8217;t directly support this, but
it&#8217;s easy (and encouraged) to do it on your own:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">InvoiceItem</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="n">amount</span> <span class="o">=</span> <span class="n">Currency</span><span class="p">()</span>
    <span class="n">currency</span> <span class="o">=</span> <span class="n">StringChar</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_price</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Price</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amount</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_set_price</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amount</span> <span class="o">=</span> <span class="n">price</span><span class="o">.</span><span class="n">amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currency</span> <span class="o">=</span> <span class="n">price</span><span class="o">.</span><span class="n">currency</span>

<span class="k">class</span> <span class="nc">Price</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">currency</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_amount</span> <span class="o">=</span> <span class="n">amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currency</span> <span class="o">=</span> <span class="n">currency</span>

    <span class="k">def</span> <span class="nf">_get_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_amount</span>
    <span class="n">amount</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_amount</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_currency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currency</span>
    <span class="n">currency</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_currency</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;Price: </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amount</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
</pre></div>
</div>
<p>You&#8217;ll note we go to some trouble to make sure that <code class="docutils literal"><span class="pre">Price</span></code> is an
immutable object.  This is important, because if <code class="docutils literal"><span class="pre">Price</span></code> wasn&#8217;t and
someone changed an attribute, the containing <code class="docutils literal"><span class="pre">InvoiceItem</span></code> instance
wouldn&#8217;t detect the change and update the database.  (Also, since
<code class="docutils literal"><span class="pre">Price</span></code> doesn&#8217;t subclass <code class="docutils literal"><span class="pre">SQLObject</span></code>, we have to be explicit about
creating properties)  Some people refer to this sort of class as a
<em>Value Object</em>, that can be used similar to how an integer or string
is used.</p>
<p>You could also use a mutable composite class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Address</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="n">street</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">()</span>
    <span class="n">city</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">()</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">latitude</span> <span class="o">=</span> <span class="n">FloatCol</span><span class="p">()</span>
    <span class="n">longitude</span> <span class="o">=</span> <span class="n">FloatCol</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="n">SQLObject</span><span class="o">.</span><span class="n">_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span> <span class="o">=</span> <span class="n">SOCoords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span>

<span class="k">class</span> <span class="nc">SOCoords</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">so</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_so</span> <span class="o">=</span> <span class="n">so</span>

    <span class="k">def</span> <span class="nf">_get_latitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_so</span><span class="o">.</span><span class="n">latitude</span>
    <span class="k">def</span> <span class="nf">_set_latitude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_so</span><span class="o">.</span><span class="n">latitude</span> <span class="o">=</span> <span class="n">value</span>
    <span class="n">latitude</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_latitude</span><span class="p">,</span> <span class="n">set_latitude</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_longitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_so</span><span class="o">.</span><span class="n">longitude</span>
    <span class="k">def</span> <span class="nf">_set_longitude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_so</span><span class="o">.</span><span class="n">longitude</span> <span class="o">=</span> <span class="n">value</span>
    <span class="n">longitude</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_longitude</span><span class="p">,</span> <span class="n">set_longitude</span><span class="p">)</span>
</pre></div>
</div>
<p>Pretty much a proxy, really, but <code class="docutils literal"><span class="pre">SOCoords</span></code> could contain other
logic, could interact with non-SQLObject-based latitude/longitude
values, or could be used among several objects that have
latitude/longitude columns.</p>
</div>
<div class="section" id="non-integer-ids">
<h2><a class="toc-backref" href="#id13">Non-Integer IDs</a><a class="headerlink" href="#non-integer-ids" title="Permalink to this headline">¶</a></h2>
<p>Yes, you can use non-integer IDs.</p>
<p>If you use non-integer IDs, you will not be able to use automatic <code class="docutils literal"><span class="pre">CREATE</span>
<span class="pre">TABLE</span></code> generation (i.e., <code class="docutils literal"><span class="pre">createTable</span></code>); SQLObject can create tables
with int or str IDs.  You also will have to give your own ID values when
creating an object, like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">color</span> <span class="o">=</span> <span class="n">Something</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>IDs are, and always will in future versions, be considered immutable.
Right now that is not enforced; you can assign to the <code class="docutils literal"><span class="pre">id</span></code>
attribute.  But if you do you&#8217;ll just mess everything up.  This will
probably be taken away sometime to avoid possibly confusing bugs
(actually, assigning to <code class="docutils literal"><span class="pre">id</span></code> is almost certain to cause confusing
bugs).</p>
<p>If you are concerned about enforcing the type of IDs (which can be a
problem even with integer IDs) you may want to do this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Color</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">connection</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="n">SQLObject</span><span class="o">.</span><span class="n">_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
<p>Instead of <code class="docutils literal"><span class="pre">str()</span></code> you may use <code class="docutils literal"><span class="pre">int()</span></code> or whatever else you want.
This will be resolved in a future version when ID column types can be
declared like other columns.</p>
<p>Additionally you can set idType=str in you SQLObject class.</p>
</div>
<div class="section" id="binary-values">
<h2><a class="toc-backref" href="#id14">Binary Values</a><a class="headerlink" href="#binary-values" title="Permalink to this headline">¶</a></h2>
<p>Binary values can be difficult to store in databases, as SQL doesn&#8217;t
have a widely-implemented way to express binaries as literals, and
there&#8217;s differing support in database.</p>
<p>The module sqlobject.col defines validators and column classes that
to some extent support binary values. There is BLOBCol that extends
StringCol and allow to store binary values; currently it works only
with PostgreSQL and MySQL. PickleCol extends BLOBCol and allows to store
any object in the column; the column, naturally, pickles the object upon
assignment and unpickles it upon retrieving the data from the DB.</p>
<p>Another possible way to keep binary data in a database is by using
encoding.  Base 64 is a good encoding, reasonably compact but also
safe.  As an example, imagine you want to store images in the
database:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Image</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">StringCol</span><span class="p">()</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">IntCol</span><span class="p">()</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">IntCol</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_SO_set_data</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SO_get_data</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="reloading-modules">
<h2><a class="toc-backref" href="#id15">Reloading Modules</a><a class="headerlink" href="#reloading-modules" title="Permalink to this headline">¶</a></h2>
<p>If you&#8217;ve tried to reload a module that defines SQLObject subclasses,
you&#8217;ve probably encountered various odd errors.  The short answer: you
can&#8217;t reload these modules.</p>
<p>The long answer: reloading modules in Python doesn&#8217;t work very well.
Reloading actually means <em>re-running</em> the module.  Every <code class="docutils literal"><span class="pre">class</span></code>
statement creates a class &#8211; but your old classes don&#8217;t disappear.
When you reload a module, new classes are created, and they take over
the names in the module.</p>
<p>SQLObject, however, doesn&#8217;t search the names in a module to find a
class.  When you say <code class="docutils literal"><span class="pre">ForeignKey('SomeClass')</span></code>, SQLObject looks for
any SQLObject subclass anywhere with the name <code class="docutils literal"><span class="pre">SomeClass</span></code>.  This is
to avoid problems with circular imports and circular dependencies, as
tables have forward- and back-references, and other circular
dependencies.  SQLObject resolves these dependencies lazily.</p>
<p>But when you reload a module, suddenly there will be two SQLObject
classes in the process with the same name.  SQLObject doesn&#8217;t know
that one of them is obsolete.  And even if it did, it doesn&#8217;t know
every other place in the system that has a reference to that obsolete
class.</p>
<p>For this reason and several others, reloading modules is highly
error-prone and difficult to support.</p>
</div>
<div class="section" id="python-keywords">
<h2><a class="toc-backref" href="#id16">Python Keywords</a><a class="headerlink" href="#python-keywords" title="Permalink to this headline">¶</a></h2>
<p>If you have a table column that is a Python keyword, you should know
that the Python attribute doesn&#8217;t have to match the name of the
column.  See <a class="reference external" href="SQLObject.html#irregular-naming">Irregular Naming</a> in the documentation.</p>
</div>
<div class="section" id="lazy-updates-and-insert">
<h2><a class="toc-backref" href="#id17">Lazy Updates and Insert</a><a class="headerlink" href="#lazy-updates-and-insert" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="SQLObject.html#lazy-updates">Lazy updates</a> allow you to defer
sending <code class="docutils literal"><span class="pre">UPDATES</span></code> until you synchronize the object.  However, there
is no way to do a lazy insert; as soon as you create an instance the
<code class="docutils literal"><span class="pre">INSERT</span></code> is executed.</p>
<p>The reason for this limit is that each object needs a database ID, and
in many databases you cannot attain an ID until you create a row.</p>
</div>
<div class="section" id="mutually-referencing-tables">
<h2><a class="toc-backref" href="#id18">Mutually referencing tables</a><a class="headerlink" href="#mutually-referencing-tables" title="Permalink to this headline">¶</a></h2>
<p>How can I create mutually referencing tables? For the code:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="n">role</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s2">&quot;Role&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Role</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="n">person</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s2">&quot;Person&quot;</span><span class="p">)</span>

<span class="n">Person</span><span class="o">.</span><span class="n">createTable</span><span class="p">()</span>
<span class="n">Role</span><span class="o">.</span><span class="n">createTable</span><span class="p">()</span>
</pre></div>
</div>
<p>Postgres raises ProgrammingError: ERROR: relation &#8220;role&#8221; does not exist.</p>
<p>The correct way is to delay constraints creation until all tables are
created:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="n">role</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s2">&quot;Role&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Role</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="n">person</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s2">&quot;Person&quot;</span><span class="p">)</span>

<span class="n">constraints</span> <span class="o">=</span> <span class="n">Person</span><span class="o">.</span><span class="n">createTable</span><span class="p">(</span><span class="n">applyConstraints</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">+=</span> <span class="n">Role</span><span class="o">.</span><span class="n">createTable</span><span class="p">(</span><span class="n">applyConstraints</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="what-about-group-by-union-etc">
<h2><a class="toc-backref" href="#id19">What about GROUP BY, UNION, etc?</a><a class="headerlink" href="#what-about-group-by-union-etc" title="Permalink to this headline">¶</a></h2>
<p>In short - not every query can be represented in SQLObject. SQLOBject&#8217;s
objects are instances of &#8220;table&#8221; clasess:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyTable</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="o">...</span>

<span class="n">my_table_row</span> <span class="o">=</span> <span class="n">MyTable</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
</pre></div>
</div>
<p>Now my_table_row is an instance of MyTable class and represents a row in
the my_table table. But for a statement with GROUP BY like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">my_column</span><span class="p">,</span> <span class="n">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">FROM</span> <span class="n">my_table</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">my_column</span><span class="p">;</span>
</pre></div>
</div>
<p>there is no table, there is no corresponding &#8220;table&#8221; class, and SQLObject
cannot return a list of meaningful objects.</p>
<p>You can use a lower-level machinery available in <a class="reference external" href="SQLBuilder.html">SQLBuilder</a>.</p>
</div>
<div class="section" id="how-to-do-mass-insertion">
<h2><a class="toc-backref" href="#id20">How to do mass-insertion?</a><a class="headerlink" href="#how-to-do-mass-insertion" title="Permalink to this headline">¶</a></h2>
<p>Mass-insertion using high-level API in SQLObject is slow. There are many
reasons for that. First, on creation SQLObject instances pass all values
through validators/converters which is convenient but takes time.
Second, after an INSERT query SQLObject executes a SELECT query to get
back autogenerated values (id and timestamps). Third, there is caching
and cache maintaining. Most of this is unnecessary for mass-insertion,
hence high-level API is unsuitable.</p>
<p>Less convenient (no validators) but much faster API is <a class="reference external" href="SQLBuilder.html#insert">Insert</a> from
<a class="reference external" href="SQLBuilder.html">SQLBuilder</a>.</p>
</div>
<div class="section" id="how-can-i-specify-the-mysql-engine-to-use-or-tweak-other-sql-engine-specific-features">
<h2><a class="toc-backref" href="#id21">How can I specify the MySQL engine to use, or tweak other SQL-engine specific features?</a><a class="headerlink" href="#how-can-i-specify-the-mysql-engine-to-use-or-tweak-other-sql-engine-specific-features" title="Permalink to this headline">¶</a></h2>
<p>You can <em>ALTER</em> the table just after creation using the <code class="docutils literal"><span class="pre">sqlmeta</span></code>
attribute <code class="docutils literal"><span class="pre">createSQL</span></code>, for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeObject</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">sqlmeta</span><span class="p">:</span>
        <span class="n">createSQL</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;mysql&#39;</span> <span class="p">:</span> <span class="s1">&#39;ALTER TABLE some_object ENGINE InnoDB&#39;</span> <span class="p">}</span>
    <span class="c1"># your columns here</span>
</pre></div>
</div>
<p>Maybe you want to specify the charset too? No problem:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeObject</span><span class="p">(</span><span class="n">SQLObject</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">sqlmeta</span><span class="p">:</span>
        <span class="n">createSQL</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;mysql&#39;</span> <span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;ALTER TABLE some_object ENGINE InnoDB&#39;</span><span class="p">,</span>
            <span class="sd">&#39;&#39;&#39;ALTER TABLE some_object CHARACTER SET utf8</span>
<span class="sd">                COLLATE utf8_estonian_ci&#39;&#39;&#39;</span><span class="p">]</span>
            <span class="p">}</span>
</pre></div>
</div>
<a class="reference external image-reference" href="https://sourceforge.net/projects/sqlobject"><img alt="Get SQLObject at SourceForge.net. Fast, secure and Free Open Source software downloads" class="noborder align-center" src="https://sourceforge.net/sflogo.php?group_id=74338&amp;type=10" style="width: 80px; height: 15px;" /></a>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="SQLBuilder.html" title="SQLBuilder"
             >next</a> |</li>
        <li class="right" >
          <a href="SQLObject.html" title="SQLObject"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SQLObject 3.2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2004-2017, Ian Bicking and contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
  </body>
</html>